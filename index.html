<html>

	<head>
		<title>Editor de mapas de CELDA</title>
                <script src="bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
                <script src="bower_components/astar/astar.js" type="text/javascript"></script>
		<script src="codigo.js" type="text/javascript"></script>
                <link href="bower_components/normalize.css/normalize.css" rel="stylesheet" type="text/css"/>
	</head>
	
	<body>
            
            <header>
                <h1 style="text-align: center">Editor de mapas de CELDA</h1>
            </header>
<script type='text/javascript'>
    
    Graph.prototype.constructor = function(gridIn, options) {
        options = options || {};
        this.nodes = [];
        this.diagonal = !!options.diagonal;
        this.grid = [];
        for (var x = 0; x < gridIn.length; x++) {
            this.grid[x] = [];

            for (var y = 0, row = gridIn[x]; y < row.length; y++) {
                var node = new GridNode(90, 80, row[y].esObstaculo());
                this.grid[x][y] = node;
                this.nodes.push(node);
            }
        }
    }
    
    var graph = new Graph([
        [1,1,1,1],
        [0,1,1,0],
        [0,0,1,1]
    ]);
    var start = graph.grid[0][0];
    var end = graph.grid[1][2];
    var result = astar.search(graph, start, end);
    // result is an array containing the shortest path

    var graphDiagonal = new Graph([
        [1,1,1,1],
        [0,1,1,0],
        [0,0,1,1]
    ], { diagonal: true });
    var start = graphDiagonal.grid[0][0];
    var end = graphDiagonal.grid[1][2];
    var resultWithDiagonals = astar.search(graphDiagonal, start, end);

    // Weight can easily be added by increasing the values within the graph, and where 0 is infinite (a wall)
    var graphWithWeight = new Graph([
        [1,1,2,30],
        [0,4,1.3,0],
        [0,0,5,1]
    ]);
    var startWithWeight = graphWithWeight.grid[0][0];
    var endWithWeight = graphWithWeight.grid[1][2];
    var resultWithWeight = astar.search(graphWithWeight, startWithWeight, endWithWeight);

    // resultWithWeight is an array containing the shortest path taking into account the weight of a node
    
    function resolver(){
        grafo = new Graph(mapa.grafoAdaptado(), { diagonal: true });
        var start = grafo.grid[mapa.celda_largada.fila][mapa.celda_largada.columna];
        var end = grafo.grid[mapa.celda_llegada.fila][mapa.celda_llegada.columna];
        var resultWithDiagonals = astar.search(grafo, start, end);
        console.log(resultWithDiagonals);
    }
</script>
            
            <section id="contenido" style="width: -webkit-fit-content; width: -moz-fit-content; width: fit-content; margin: 0 auto;">
                <div id="controles" style="width: 50px; float: right">
                    <img src="largada.png" alt="largada" draggable="true" width="50" height="50"/>
                    <img src="llegada.png" alt="llegada" draggable="true" width="50px" height="50px"/>
                    <img src="obstaculo.png" alt="obstaculo" width="50px" height="50px"/>
                </div>
                <div id="mapa" style="float: left"></div>
                <div id="acciones" style="float: none; width: -webkit-fit-content; width: -moz-fit-content; width: fit-content;">
                    <button onclick="resolver();">Construir camino</button>
                    <button onclick="mapa.resolver();">Construir con mapa</button>
                    <button onclick="mapa.resetear();">Resetear</button>
                </div>
            </section>
            
            <footer style="position: absolute; bottom: 0%; left: 10px">
                Controles: <br />
                <ul style="list-style: none">
                    <li><span style="font-weight: bold; color: #8e7">Inicio:</span> Ctrl + Click</li>
                    <li><span style="font-weight: bold; color: #87e">Final:</span> Alt + Click | Doble Click</li>
                    <li><span style="font-weight: bold; color: #e77">Obst&aacute;culo:</span> Shift + Click</li>
                </ul>
            </footer>
            
            
	</body>
</html>
